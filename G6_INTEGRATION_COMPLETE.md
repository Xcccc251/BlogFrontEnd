# G6 çŸ¥è¯†å›¾è°±å¯è§†åŒ–é›†æˆå®Œæˆ

## âœ… å·²å®Œæˆçš„åŠŸèƒ½

### 1. G6åº“å®‰è£…

```bash
npm install @antv/g6@4.8.24
```

ç‰ˆæœ¬ï¼š`@antv/g6@4.8.24` ï¼ˆç¨³å®šç‰ˆæœ¬ï¼‰

---

### 2. æ ¸å¿ƒåŠŸèƒ½å®ç°

#### ğŸ¨ å›¾è°±å¯è§†åŒ–
- âœ… ä½¿ç”¨G6 ForceåŠ›å¯¼å‘å¸ƒå±€
- âœ… èŠ‚ç‚¹è‡ªåŠ¨æ’å¸ƒï¼Œé¿å…é‡å 
- âœ… è¾¹å¸¦ç®­å¤´æ˜¾ç¤ºæ–¹å‘
- âœ… èŠ‚ç‚¹å¤§å°æ ¹æ®å…¥åº¦ï¼ˆç‚¹èµæ•°ï¼‰åŠ¨æ€è°ƒæ•´
- âœ… æ”¯æŒç¼©æ”¾ã€æ‹–æ‹½ç”»å¸ƒ
- âœ… æ”¯æŒæ‹–æ‹½èŠ‚ç‚¹

#### ğŸ¨ èŠ‚ç‚¹æ ·å¼å·®å¼‚åŒ–
æ ¹æ®èŠ‚ç‚¹ç±»å‹è®¾ç½®ä¸åŒé¢œè‰²ï¼š
- **Userï¼ˆç”¨æˆ·ï¼‰**: è“è‰² `#5B8FF9`
- **Articleï¼ˆæ–‡ç« ï¼‰**: ç»¿è‰² `#5AD8A6`
- **Categoryï¼ˆåˆ†ç±»ï¼‰**: é»„è‰² `#F6BD16`
- **Tagï¼ˆæ ‡ç­¾ï¼‰**: çº¢è‰² `#E86452`

#### ğŸ–±ï¸ äº¤äº’åŠŸèƒ½
- âœ… **èŠ‚ç‚¹æ‚¬åœ**: æ˜¾ç¤ºé«˜äº®è¾¹æ¡†ï¼ˆè“è‰²ï¼‰
- âœ… **èŠ‚ç‚¹ç‚¹å‡»**: é€‰ä¸­çŠ¶æ€ï¼ˆçº¢è‰²è¾¹æ¡†ï¼‰+ è§¦å‘AIå¯¹è¯
- âœ… **è¾¹æ‚¬åœ**: æ˜¾ç¤ºé«˜äº®æ•ˆæœ
- âœ… **Tooltipæç¤º**: æ‚¬åœæ˜¾ç¤ºèŠ‚ç‚¹ç±»å‹å’Œå®Œæ•´æ ‡ç­¾
- âœ… **èŠ‚ç‚¹æ‹–æ‹½**: å¯ä»¥æ‹–åŠ¨è°ƒæ•´ä½ç½®
- âœ… **ç”»å¸ƒç¼©æ”¾**: é¼ æ ‡æ»šè½®ç¼©æ”¾
- âœ… **ç”»å¸ƒå¹³ç§»**: æ‹–æ‹½ç©ºç™½åŒºåŸŸç§»åŠ¨è§†å›¾

#### ğŸ¤– AIè”åŠ¨
- âœ… ç‚¹å‡»èŠ‚ç‚¹è‡ªåŠ¨ç”ŸæˆAIé—®é¢˜
- âœ… æ ¹æ®èŠ‚ç‚¹ç±»å‹ç”Ÿæˆä¸åŒçš„è¯¢é—®è¯­å¥
- âœ… AIå›ç­”ç›´æ¥æ˜¾ç¤ºåœ¨å³ä¾§å¯¹è¯åŒº

#### ğŸ“ å“åº”å¼å¸ƒå±€
- âœ… çª—å£å¤§å°å˜åŒ–æ—¶è‡ªåŠ¨è°ƒæ•´å›¾è°±å¤§å°
- âœ… åˆ†å‰²å™¨æ‹–åŠ¨æ—¶åŒæ­¥è°ƒæ•´å›¾è°±å°ºå¯¸
- âœ… è‡ªé€‚åº”ç”»å¸ƒï¼ˆfitViewï¼‰

---

## ğŸ¯ ä½¿ç”¨è¯´æ˜

### å¯åŠ¨æœåŠ¡

```bash
# 1. åç«¯æœåŠ¡
cd my-blogv2
go run main.go

# 2. å‰ç«¯æœåŠ¡
cd kuailemao-blog
npm run dev

# 3. è®¿é—®é¡µé¢
æµè§ˆå™¨æ‰“å¼€: http://localhost:ç«¯å£/graph
```

### æ“ä½œæŒ‡å—

#### åŸºæœ¬æ“ä½œ
- **å¹³ç§»ç”»å¸ƒ**: é¼ æ ‡æ‹–æ‹½ç©ºç™½åŒºåŸŸ
- **ç¼©æ”¾ç”»å¸ƒ**: é¼ æ ‡æ»šè½®
- **æ‹–åŠ¨èŠ‚ç‚¹**: é¼ æ ‡æ‹–æ‹½èŠ‚ç‚¹
- **é€‰æ‹©èŠ‚ç‚¹**: å•å‡»èŠ‚ç‚¹
- **æŸ¥çœ‹è¯¦æƒ…**: æ‚¬åœåœ¨èŠ‚ç‚¹ä¸ŠæŸ¥çœ‹Tooltip

#### AIäº¤äº’
1. **ç‚¹å‡»èŠ‚ç‚¹**: ä¼šè‡ªåŠ¨åœ¨å³ä¾§AIå¯¹è¯æ¡†ä¸­å‘èµ·è¯¢é—®
2. **è¯¢é—®æ ¼å¼**:
   - UserèŠ‚ç‚¹: "è¯·ä»‹ç»ä¸€ä¸‹ç”¨æˆ·èŠ‚ç‚¹ï¼šå¼ ä¸‰ï¼ˆID: user_1ï¼‰"
   - ArticleèŠ‚ç‚¹: "è¯·ä»‹ç»ä¸€ä¸‹æ–‡ç« èŠ‚ç‚¹ï¼šVue3å“åº”å¼åŸç†ï¼ˆID: article_1ï¼‰"
   - CategoryèŠ‚ç‚¹: "è¯·ä»‹ç»ä¸€ä¸‹åˆ†ç±»èŠ‚ç‚¹ï¼šå‰ç«¯å¼€å‘ï¼ˆID: category_1ï¼‰"
   - TagèŠ‚ç‚¹: "è¯·ä»‹ç»ä¸€ä¸‹æ ‡ç­¾èŠ‚ç‚¹ï¼šVueï¼ˆID: tag_1ï¼‰"

3. **AIå›ç­”**: åŸºäºå›¾è°±æ•°æ®å’Œä¸Šä¸‹æ–‡è‡ªåŠ¨ç”Ÿæˆ

---

## ğŸ¨ è§†è§‰æ•ˆæœ

### èŠ‚ç‚¹çŠ¶æ€

| çŠ¶æ€ | è¾¹æ¡†é¢œè‰² | è¾¹æ¡†å®½åº¦ | è¯´æ˜ |
|------|---------|---------|------|
| é»˜è®¤ | èŠ‚ç‚¹ç±»å‹è‰² | 2px | æ­£å¸¸æ˜¾ç¤º |
| æ‚¬åœ | è“è‰² `#1890ff` | 3px | é¼ æ ‡æ‚¬åœ |
| é€‰ä¸­ | çº¢è‰² `#f5222d` | 3px | ç‚¹å‡»é€‰ä¸­ |

### èŠ‚ç‚¹å¤§å°

```javascript
size = 25 + (inDegree * 2)
// æœ€å°: 25px
// æœ€å¤§: 50px
// inDegree: èŠ‚ç‚¹å…¥åº¦ï¼ˆè¢«å¤šå°‘ç”¨æˆ·ç‚¹èµï¼‰
```

çƒ­é—¨èŠ‚ç‚¹ï¼ˆé«˜å…¥åº¦ï¼‰ä¼šæ˜¾ç¤ºå¾—æ›´å¤§ã€‚

---

## ğŸ“Š æŠ€æœ¯ç»†èŠ‚

### G6é…ç½®

```typescript
graph = new G6.Graph({
  container: graphContainer.value,
  width, height,
  layout: {
    type: 'force',              // åŠ›å¯¼å‘å¸ƒå±€
    preventOverlap: true,       // é˜²æ­¢èŠ‚ç‚¹é‡å 
    nodeSpacing: 100,           // èŠ‚ç‚¹é—´è·
    linkDistance: 150,          // è¾¹é•¿åº¦
    nodeStrength: -50,          // èŠ‚ç‚¹æ–¥åŠ›
    edgeStrength: 0.3,          // è¾¹å¼•åŠ›
    collideStrength: 0.8,       // ç¢°æ’å¼ºåº¦
  },
  modes: {
    default: [
      'drag-canvas',   // æ‹–æ‹½ç”»å¸ƒ
      'zoom-canvas',   // ç¼©æ”¾ç”»å¸ƒ
      'drag-node',     // æ‹–æ‹½èŠ‚ç‚¹
      { type: 'tooltip' }  // æç¤ºæ¡†
    ],
  },
})
```

### æ•°æ®æ ¼å¼è½¬æ¢

åç«¯è¿”å›æ ¼å¼ â†’ G6æ ¼å¼ï¼š

```typescript
// åç«¯æ ¼å¼
{
  id: "article_1",
  label: "Article",
  properties: { title: "Vue3å“åº”å¼åŸç†", ... }
}

// G6æ ¼å¼
{
  id: "article_1",
  label: "Vue3å“åº”å¼åŸç†",
  type: "Article",
  style: { fill: "#5AD8A6", stroke: "#5AD8A6" },
  size: 35,  // æ ¹æ®å…¥åº¦è®¡ç®—
}
```

### äº‹ä»¶å¤„ç†

```typescript
// èŠ‚ç‚¹ç‚¹å‡»
graph.on('node:click', (evt) => {
  const node = evt.item
  const model = node.getModel()
  
  // 1. æ›´æ–°é€‰ä¸­çŠ¶æ€
  graph.setItemState(node, 'selected', true)
  
  // 2. è§¦å‘AIå¯¹è¯
  sendAiMessage(`è¯·ä»‹ç»èŠ‚ç‚¹: ${model.label}`)
})

// èŠ‚ç‚¹æ‚¬åœ
graph.on('node:mouseenter', (evt) => {
  graph.setItemState(evt.item, 'hover', true)
})

// çª—å£resize
window.addEventListener('resize', () => {
  graph.changeSize(newWidth, newHeight)
  graph.fitView(20)
})
```

---

## ğŸ”§ è‡ªå®šä¹‰é…ç½®

### ä¿®æ”¹èŠ‚ç‚¹é¢œè‰²

åœ¨ `Graph/index.vue` ä¸­ä¿®æ”¹ `nodeColorMap`ï¼š

```typescript
const nodeColorMap: Record<string, string> = {
  User: '#5B8FF9',       // è“è‰²
  Article: '#5AD8A6',    // ç»¿è‰²  
  Category: '#F6BD16',   // é»„è‰²
  Tag: '#E86452',        // çº¢è‰²
  // æ·»åŠ æ–°ç±»å‹
  CustomType: '#8B5CF6', // ç´«è‰²
}
```

### ä¿®æ”¹å¸ƒå±€ç®—æ³•

```typescript
layout: {
  type: 'circular',  // æ”¹ä¸ºåœ†å½¢å¸ƒå±€
  // type: 'radial',    // å¾„å‘å¸ƒå±€
  // type: 'dagre',     // å±‚æ¬¡å¸ƒå±€
  // type: 'grid',      // ç½‘æ ¼å¸ƒå±€
}
```

### ä¿®æ”¹èŠ‚ç‚¹å¤§å°è§„åˆ™

```typescript
size: Math.max(30, Math.min(60, 30 + (node.stats?.inDegree || 0) * 3)),
//    æœ€å°å€¼30   æœ€å¤§å€¼60   åŸºç¡€å¤§å°30 + å…¥åº¦*3
```

### ä¿®æ”¹è¾¹çš„æ ·å¼

```typescript
defaultEdge: {
  style: {
    stroke: '#999',      // è¾¹é¢œè‰²
    lineWidth: 2,        // è¾¹å®½åº¦
    lineDash: [4, 2],    // è™šçº¿ [å®çº¿é•¿åº¦, é—´éš”é•¿åº¦]
  },
}
```

---

## ğŸ› å¸¸è§é—®é¢˜

### Q1: å›¾è°±ä¸æ˜¾ç¤º

**æ£€æŸ¥**:
1. åç«¯æœåŠ¡æ˜¯å¦å¯åŠ¨ï¼ˆç«¯å£7001ï¼‰
2. å›¾è°±æ•°æ®æ˜¯å¦åŠ è½½æˆåŠŸï¼ˆæŸ¥çœ‹æ§åˆ¶å°ï¼‰
3. Neo4jæ•°æ®æ˜¯å¦å·²åŒæ­¥
4. graphContainerå®¹å™¨æ˜¯å¦å­˜åœ¨

**è§£å†³**:
```bash
# æ£€æŸ¥åç«¯æ¥å£
curl http://localhost:7001/graph/overview

# åŒæ­¥Neo4jæ•°æ®
curl -X POST http://localhost:7001/neo4j/sync/all
```

### Q2: èŠ‚ç‚¹é‡å 

**åŸå› **: æ•°æ®é‡å¤ªå¤§æˆ–å¸ƒå±€å‚æ•°ä¸åˆé€‚

**è§£å†³**:
```typescript
layout: {
  nodeSpacing: 150,      // å¢åŠ èŠ‚ç‚¹é—´è·
  linkDistance: 200,     // å¢åŠ è¾¹é•¿åº¦
  preventOverlap: true,  // ç¡®ä¿å¼€å¯é˜²é‡å 
}
```

### Q3: æ€§èƒ½å¡é¡¿

**åŸå› **: èŠ‚ç‚¹æ•°é‡è¿‡å¤šï¼ˆ> 500ä¸ªï¼‰

**è§£å†³**:
1. å‡å°‘ `limit` å‚æ•°
2. ä½¿ç”¨åˆ†é¡µåŠ è½½
3. å¯ç”¨G6çš„æ€§èƒ½ä¼˜åŒ–æ¨¡å¼

```typescript
// ä¿®æ”¹åŠ è½½æ•°æ®çš„limit
const response = await fetch('http://localhost:7001/graph/overview?limit=50')
```

### Q4: ç‚¹å‡»èŠ‚ç‚¹æ— ååº”

**æ£€æŸ¥**:
1. äº‹ä»¶ç›‘å¬æ˜¯å¦æ­£ç¡®æ³¨å†Œ
2. æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯
3. AIå¯¹è¯åŠŸèƒ½æ˜¯å¦æ­£å¸¸

**è°ƒè¯•**:
```typescript
graph.on('node:click', (evt) => {
  console.log('èŠ‚ç‚¹è¢«ç‚¹å‡»:', evt.item.getModel())
})
```

### Q5: çª—å£resizeåå›¾è°±å˜å½¢

**åŸå› **: æ²¡æœ‰ç›‘å¬resizeäº‹ä»¶

**å·²è§£å†³**: ä»£ç ä¸­å·²æ·»åŠ resizeç›‘å¬å’Œè‡ªåŠ¨è°ƒæ•´

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. å¤§æ•°æ®é‡ä¼˜åŒ–

```typescript
// ä½¿ç”¨åˆ†é¡µåŠ è½½
const loadMoreNodes = async (page: number) => {
  const response = await fetch(`/graph/nodes?page=${page}&size=50`)
  const newNodes = response.data.nodes
  
  // å¢é‡æ·»åŠ èŠ‚ç‚¹
  graph.addItem('node', newNodes)
}
```

### 2. é™ä½æ¸²æŸ“è´¨é‡

```typescript
graph = new G6.Graph({
  // ...å…¶ä»–é…ç½®
  pixelRatio: 1,           // é™ä½åƒç´ æ¯”
  renderer: 'canvas',      // ä½¿ç”¨canvasæ¸²æŸ“ï¼ˆé»˜è®¤ï¼‰
  animate: false,          // å…³é—­åŠ¨ç”»
})
```

### 3. æŒ‰éœ€åŠ è½½é‚»å±…èŠ‚ç‚¹

```typescript
// åŒå‡»èŠ‚ç‚¹å±•å¼€é‚»å±…
graph.on('node:dblclick', async (evt) => {
  const nodeId = evt.item.getModel().id
  const neighbors = await fetchNeighbors(nodeId)
  
  neighbors.forEach(neighbor => {
    graph.addItem('node', neighbor)
  })
})
```

---

## ğŸš€ æ‰©å±•åŠŸèƒ½å»ºè®®

### 1. å³é”®èœå•

```typescript
import { ContextMenu } from '@antv/g6'

graph = new G6.Graph({
  plugins: [
    new ContextMenu({
      getContent(evt) {
        return `
          <ul>
            <li>æŸ¥çœ‹è¯¦æƒ…</li>
            <li>å±•å¼€é‚»å±…</li>
            <li>éšè—èŠ‚ç‚¹</li>
          </ul>
        `
      },
    }),
  ],
})
```

### 2. å›¾ä¾‹

```typescript
import { Legend } from '@antv/g6'

graph = new G6.Graph({
  plugins: [
    new Legend({
      data: {
        nodes: [
          { id: 'User', label: 'ç”¨æˆ·', color: '#5B8FF9' },
          { id: 'Article', label: 'æ–‡ç« ', color: '#5AD8A6' },
          { id: 'Category', label: 'åˆ†ç±»', color: '#F6BD16' },
          { id: 'Tag', label: 'æ ‡ç­¾', color: '#E86452' },
        ],
      },
    }),
  ],
})
```

### 3. æœç´¢é«˜äº®

```typescript
const searchNode = (keyword: string) => {
  const nodes = graph.getNodes()
  
  nodes.forEach(node => {
    const model = node.getModel()
    const label = model.fullLabel || model.label
    
    if (label.includes(keyword)) {
      graph.setItemState(node, 'highlight', true)
    } else {
      graph.clearItemStates(node, 'highlight')
    }
  })
}
```

### 4. å¯¼å‡ºå›¾ç‰‡

```typescript
const exportImage = () => {
  graph.downloadFullImage('knowledge-graph', 'image/png', {
    backgroundColor: '#fff',
    padding: [20, 20, 20, 20],
  })
}
```

---

## ğŸ“š å‚è€ƒèµ„æ–™

- [G6 å®˜æ–¹æ–‡æ¡£](https://g6.antv.antgroup.com/)
- [G6 APIæ–‡æ¡£](https://g6.antv.antgroup.com/api/graph)
- [G6 ç¤ºä¾‹åº“](https://g6.antv.antgroup.com/examples)
- [Forceå¸ƒå±€æ–‡æ¡£](https://g6.antv.antgroup.com/api/graphLayout/force)

---

## ğŸ“ æ–‡ä»¶æ¸…å•

| æ–‡ä»¶ | ä¿®æ”¹ç±»å‹ | è¯´æ˜ |
|------|---------|------|
| `package.json` | æ–°å¢ä¾èµ– | æ·»åŠ  @antv/g6@4.8.24 |
| `src/views/Graph/index.vue` | é‡å¤§ä¿®æ”¹ | é›†æˆG6ï¼Œå®ç°å®Œæ•´å¯è§†åŒ– |
| `G6_INTEGRATION_COMPLETE.md` | æ–°å»º | æœ¬æ–‡æ¡£ |

---

**é›†æˆå®Œæˆæ—¶é—´**: 2024-01-15  
**G6ç‰ˆæœ¬**: 4.8.24  
**çŠ¶æ€**: âœ… å®Œæ•´å¯ç”¨
